(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c417892"],{"023c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sgs-record-v2"},[t("div",{staticClass:"wrapper"},[t("div",{staticClass:"query-box"},[t("div",{staticClass:"border"},[t("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[t("el-form-item",{attrs:{label:"模式",prop:"labelmodel"}},[t("el-radio-group",{staticStyle:{width:"240px"},model:{value:e.queryParams.labelmodel,callback:function(t){e.$set(e.queryParams,"labelmodel",t)},expression:"queryParams.labelmodel"}},e._l(e.labelmodelArr,(function(a){return t("el-radio-button",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label)+" ")])})),1)],1),t("el-form-item",{attrs:{label:"日期",prop:"endtime"}},[t("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange",align:"left","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions,size:"mini","append-to-body":!1,"value-format":"timestamp"},on:{change:e.dateChange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("el-form-item",{attrs:{label:"玩家",prop:"mainUserid"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"搜索/选择玩家",clearable:"",filterable:""},model:{value:e.queryParams.mainUserid,callback:function(t){e.$set(e.queryParams,"mainUserid",t)},expression:"queryParams.mainUserid"}},e._l(e.pwUserList,(function(e){return t("el-option",{key:e.userid,attrs:{label:e.nickname,value:e.userid}})})),1)],1),t("el-form-item",{attrs:{label:"武将",prop:"mainGeneral"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"搜索/选择武将",clearable:"",filterable:""},model:{value:e.queryParams.mainGeneral,callback:function(t){e.$set(e.queryParams,"mainGeneral",t)},expression:"queryParams.mainGeneral"}},e._l(e.wjArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"胜负",prop:"result"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"选择胜负",clearable:"",filterable:""},model:{value:e.queryParams.result,callback:function(t){e.$set(e.queryParams,"result",t)},expression:"queryParams.result"}},e._l(e.resultArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("查询")]),t("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")]),t("el-button",{attrs:{type:"success",loading:e.syncLoading,icon:"el-icon-cloudy",size:"mini"},on:{click:e.handleSync}},[e._v("同步")])],1)],1),e._m(0),e._m(1)],1)]),t("div",{staticClass:"record-box"},[t("el-row",{attrs:{gutter:40}},[t("el-col",{attrs:{span:14}},[t("div",{staticClass:"record-title"},[t("i",{staticClass:"icon-record"}),e._v(" "+e._s("132"==e.labelmodel?"排位":"斗地主")+"对局："),t("span",{staticStyle:{color:"#bea879"}},[e._v(e._s(e.pwRecordList.length))]),e._v(" ， 胜场："),t("span",{staticClass:"color-red"},[e._v(e._s(e.win))]),e._v("， 败场："),t("span",{staticClass:"color-green"},[e._v(e._s(e.lost))]),e._v("， 胜率："),t("span",{staticClass:"color-blue"},[e._v(e._s(e.rate)+"%")]),t("div",{staticClass:"record-title-btns"},[t("el-switch",{attrs:{"active-text":"隐藏玩家名称","active-color":"#bea879","inactive-color":"#EBEEF5"},model:{value:e.hideUsername,callback:function(t){e.hideUsername=t},expression:"hideUsername"}}),t("el-switch",{staticClass:"ml-20",attrs:{"active-text":"时间正序","active-color":"#bea879","inactive-color":"#EBEEF5"},model:{value:e.timeOrder,callback:function(t){e.timeOrder=t},expression:"timeOrder"}})],1)]),"132"==e.labelmodel?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.pwRecordList,border:e.tableBorder}},[t("el-table-column",{attrs:{label:"日期",align:"center",prop:"endtime",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.parseTime(t.row.endtime-28800,"{m}月{d}日 {h}:{i}","sgs"))+" ")]}}],null,!1,1964118916)}),t("el-table-column",{attrs:{label:e.hideUsername?"位置":"2/4位",align:"center",prop:"subUserid"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.hideUsername?"2/4":e.pwUserMap[t.row.subUserid])+" ")]}}],null,!1,2589724435)}),t("el-table-column",{attrs:{label:"副将",align:"center",prop:"subGeneral"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.wjMap[t.row.subGeneral])+" ")]}}],null,!1,1392481736)}),t("el-table-column",{attrs:{label:"主将",align:"center",prop:"mainGeneral"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.wjMap[t.row.mainGeneral])+" ")]}}],null,!1,2005478695)}),t("el-table-column",{attrs:{label:e.hideUsername?"位置":"1/3位",align:"center",prop:"mainUserid"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.hideUsername?"1/3":e.pwUserMap[t.row.mainUserid])+" ")]}}],null,!1,1372667544)}),t("el-table-column",{attrs:{label:"胜负",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"==a.row.result?t("span",{staticClass:"color-lightred"},[e._v(" 胜利 ")]):t("span",{staticClass:"color-lightgreen"},[e._v("失败")])]}}],null,!1,1696334572)})],1):e._e(),"149"==e.labelmodel?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.pwRecordList,border:e.tableBorder}},[t("el-table-column",{attrs:{label:"日期",align:"center",prop:"endtime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.parseTime(t.row.endtime-28800,"{m}月{d}日 {h}:{i}","sgs"))+" ")]}}],null,!1,1964118916)}),t("el-table-column",{attrs:{label:"玩家",align:"center",prop:"mainUserid"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.hideUsername?"—":e.pwUserMap[t.row.mainUserid])+" ")]}}],null,!1,52673793)}),t("el-table-column",{attrs:{label:"选将",align:"center",prop:"mainGeneral"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.wjMap[t.row.mainGeneral])+" ")]}}],null,!1,2005478695)}),t("el-table-column",{attrs:{label:"身份",align:"center",prop:"figure"},scopedSlots:e._u([{key:"default",fn:function(a){return["1"==a.row.figure?t("span",{staticClass:"color-gold"},[e._v(" 地主 ")]):"3"==a.row.figure?t("span",{staticClass:"color-lightblue"},[e._v(" 农民 ")]):t("span",{staticClass:"color-gray"},[e._v("平局")])]}}],null,!1,1782595847)}),t("el-table-column",{attrs:{label:"胜负",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"==a.row.result?t("span",{staticClass:"color-lightred"},[e._v(" 胜利 ")]):t("span",{staticClass:"color-lightgreen"},[e._v("失败")])]}}],null,!1,1696334572)})],1):e._e(),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{layout:"sizes, prev, pager, next","current-page":e.queryParams.pageNum,"page-sizes":[20,100,400,999,9999],"page-size":e.queryParams.pageSize,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"record-title"},[t("i",{staticClass:"icon-wj"}),e._v(" 武将胜率统计 ")]),t("el-table",{attrs:{data:e.wjRateArr,border:e.tableBorder,"default-sort":{prop:"total",order:"descending"}}},[t("el-table-column",{attrs:{prop:"wjId",label:"武将",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.wjMap[t.row.wjId])+" ")]}}])}),t("el-table-column",{attrs:{label:"出场",sortable:"","sort-method":e.sortByTotal,"sort-orders":["descending","ascending"],align:"center",prop:"total"}}),t("el-table-column",{attrs:{label:"胜场",sortable:"","sort-method":e.sortByWin,"sort-orders":["descending","ascending"],align:"center",prop:"win"}}),t("el-table-column",{attrs:{label:"败场",sortable:"","sort-method":e.sortByLost,"sort-orders":["descending","ascending"],align:"center",prop:"lost"}}),t("el-table-column",{attrs:{label:"胜率",sortable:"","sort-method":e.sortByRate,"sort-orders":["descending","ascending"],align:"center",prop:"rate"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.rate)+"% ")]}}])})],1)],1)],1)],1)])])},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"info-title"},[t("span",{staticClass:"color-gray"},[e._v("[")]),e._v(" 使用说明 "),t("span",{staticClass:"color-gray"},[e._v("]")])])},function(){var e=this,t=e._self._c;return t("ul",{staticClass:"info-content"},[t("li",[e._v(" 可查询欢乐排位、斗地主两种模式所有战绩。每天超过51局后不会覆盖旧战绩。 ")]),t("li",[e._v(" 每隔1小时自动同步最新数据。也可以点击绿色“同步”按钮，手动同步。 ")]),t("li",[e._v("右侧表格自动计算出场武将胜率，点击表头可排序。")]),t("li",[e._v("初上线可能有bug，欢迎反馈 : ）")]),t("li",[e._v("制作：埃城")]),t("li",[e._v("鸣谢：小胡")])])}],s=a("d8de"),i=a("cee4"),n={name:"PwRecord",data(){return{loading:!0,syncLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,pwRecordList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:9999,labelmodel:"132",sTime:null,eTime:null,mainUserid:null,mainGeneral:null,subUserid:null,subGeneral:null,result:null},form:{},rules:{},wjArr:[],pwUserList:[],pwUserMap:{},wjMap:s,resultArr:[{label:"胜",value:"0"},{label:"负",value:"1"}],labelmodelArr:[{label:"排位",value:"132"},{label:"斗地主",value:"149"}],dateRange:[(new Date).getTime(),(new Date).getTime()],pickerOptions:{shortcuts:[{text:"本月",onClick(e){const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1);a.setTime(a.getTime()),e.$emit("pick",[a,t])}}],firstDayOfWeek:1,disabledDate(e){let t=Date.now(),a=(t-e.getTime())/864e5;return a<0}},apiUrl:"http://121.40.102.52/prod-api/",win:0,lost:0,rate:0,wjRateMap:{},wjRateArr:[],hideUsername:!1,timeOrder:!1,labelmodel:"132",tableBorder:!0}},created(){this.wjArr=[];for(let e in s)this.wjArr.push({label:s[e],value:e});this.resetDate(),Object(i["a"])({url:this.apiUrl+"/sgs/pwUser/list",method:"GET",params:{pageNum:1,pageSize:1e3}}).then(e=>{this.pwUserList=e.data.rows.filter(e=>e.status),this.pwUserList.forEach(e=>{this.pwUserMap[e.userid]=e.nickname}),this.getList()})},mounted(){},watch:{timeOrder(e){this.pwRecordList.sort(this.compare("gameid",!e))}},methods:{resetDate(){this.dateRange=[(new Date).getTime(),(new Date).getTime()];const e=new Date((new Date).toLocaleDateString()).getTime();console.log(e,"today"),this.queryParams.sTime=e/1e3+28800,this.queryParams.eTime=e/1e3+115200},handleSync(){this.syncLoading=!0,Object(i["a"])({url:this.apiUrl+"/sgs/pwRecord/sync",method:"GET",params:{}}).then(e=>{200==e.data.code?this.$message.success(e.data.msg):this.$message(e.data.msg)}).finally(()=>{this.syncLoading=!1})},getList(){this.loading=!0,this.pwRecordList=[],this.labelmodel=this.queryParams.labelmodel,console.log(this.dateRange,"this.dateRange"),Object(i["a"])({url:this.apiUrl+"/sgs/pwRecord/list",method:"GET",params:this.queryParams}).then(e=>{this.pwRecordList=e.data.rows,this.total=e.data.total,this.timeOrder&&this.pwRecordList.sort(this.compare("gameid",!1)),this.loading=!1,this.formatTableData()})},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetDate(),this.$refs["queryForm"].resetFields(),this.handleQuery()},dateChange(e){console.log(e),this.queryParams.sTime=e[0]/1e3+28800,this.queryParams.eTime=e[1]/1e3+115200},handleSizeChange(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange(e){this.queryParams.pageNum=e,this.getList()},formatTableData(){this.win=0,this.lost=0,this.rate=0,this.wjRateMap={},this.pwRecordList.length<1||(this.pwRecordList.forEach(e=>{"0"==e.result?this.win++:this.lost++,this.fotmatWjRate(e)}),this.rate=Number(this.win/this.pwRecordList.length*100).toFixed(1),this.formatWjRateArr())},fotmatWjRate(e){const{mainGeneral:t,subGeneral:a,result:r}=e;t&&!this.wjRateMap[t]&&(this.wjRateMap[t]={wjId:t,lost:0,win:0,total:0,rate:0}),a&&!this.wjRateMap[a]&&(this.wjRateMap[a]={wjId:a,lost:0,win:0,total:0,rate:0}),"0"==r?(t&&this.wjRateMap[t].win++,a&&this.wjRateMap[a].win++):(t&&this.wjRateMap[t].lost++,a&&this.wjRateMap[a].lost++)},formatWjRateArr(){this.wjRateArr=[];for(let e in this.wjRateMap)this.wjRateMap[e].total=this.wjRateMap[e].lost+this.wjRateMap[e].win,this.wjRateMap[e].rate=(this.wjRateMap[e].win/this.wjRateMap[e].total*100).toFixed(1),this.wjRateArr.push(this.wjRateMap[e]);console.log(this.wjRateArr,"wjRateArr")},sortByTotal(e,t){return Number(e.total)-Number(t.total)},sortByWin(e,t){return Number(e.win)-Number(t.win)},sortByLost(e,t){return Number(e.lost)-Number(t.lost)},sortByRate(e,t){return Number(e.rate)-Number(t.rate)},compare(e,t){return function(a,r){var l=a[e],s=r[e];return t?s-l:l-s}},parseTime(e,t,a){if(0===arguments.length||!e)return null;const r=t||"{y}-{m}-{d} {h}:{i}:{s}";let l;"object"===typeof e?l=e:("string"===typeof e&&/^[0-9]+$/.test(e)?e=parseInt(e):"string"===typeof e&&(e=e.replace(new RegExp(/-/gm),"/").replace("T"," ").replace(new RegExp(/\.[\d]{3}/gm),"")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),l=new Date(e));const s={y:l.getFullYear(),m:l.getMonth()+1,d:l.getDate(),h:l.getHours(),i:l.getMinutes(),s:l.getSeconds(),a:l.getDay()},i=r.replace(/{(y|m|d|h|i|s|a)+}/g,(e,t)=>{let r=s[t];return"a"===t?["日","一","二","三","四","五","六"][r]:"sgs"==a?(e.length>0&&r<10&&"m"!=t&&"d"!=t&&(r="0"+r),r||0):(e.length>0&&r<10&&(r="0"+r),r||0)});return i}}},o=n,c=(a("09f3"),a("1a38"),a("2877")),u=Object(c["a"])(o,r,l,!1,null,"58073d96",null);t["default"]=u.exports},"09f3":function(e,t,a){"use strict";a("a9f5")},"1a38":function(e,t,a){"use strict";a("3aae")},"3aae":function(e,t,a){},a9f5:function(e,t,a){}}]);
//# sourceMappingURL=chunk-6c417892.d3f89248.js.map